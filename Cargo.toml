[package]
name = "screenerbot"
version = "0.1.0"
edition = "2021"

# Workspace optimization for faster builds
[workspace]
resolver = "2"

# Dev profile — fastest possible compile + good debugging
[profile.dev]
opt-level = 0
debug = 0                # no debug info -> much faster compile/link
incremental = true
codegen-units = 256
lto = false
panic = "abort"          # simpler codegen, faster builds
debug-assertions = false  # skip extra checks for speed
overflow-checks = false   # skip integer overflow checks

# Release profile — optimized but still fast to compile
[profile.release]
opt-level = 3         # Full optimizations for runtime speed
lto = "thin"          # Faster LTO than "fat"
codegen-units = 1     # Better runtime perf (slower compile, but still reasonable)
incremental = false   # Avoids some LTO instability
debug = false         # Smaller binary, faster link
panic = "abort"       # Reduces binary size
strip = "debuginfo"   # Strips symbols except needed for backtraces

# Optional: profile for "fast-release" builds (good runtime perf, much faster than full release)
[profile.fast-release]
inherits = "release"
lto = false
codegen-units = 8
opt-level = 2



[lib]
name = "screenerbot"
path = "src/lib.rs"

[[bin]]
name = "screenerbot"
path = "src/main.rs"

[[bin]]
name = "debug_pool_service_single_token"
path = "src/bin/debug_pool_service_single_token.rs"

[[bin]]
name = "main_sell_all_and_reset"
path = "src/bin/main_sell_all_and_reset.rs"



[dependencies]
# Core async runtime with minimal features for faster builds
tokio = { version = "1", features = ["rt-multi-thread", "macros", "sync", "time", "fs", "net"] }

# Essential dependencies
anyhow = "1.0"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
chrono = { version = "0.4", features = ["serde"] }
once_cell = "1.19"

# Optimized HTTP client
reqwest = { version = "0.11", features = ["json", "rustls-tls"] }

# WebSocket support for real-time transaction monitoring
tokio-tungstenite = { version = "0.21", features = ["connect", "rustls-tls-native-roots"] }

# Database with bundled sqlite for faster builds
rusqlite = { version = "0.29", features = ["bundled"] }
r2d2 = "0.8"
r2d2_sqlite = "0.22"

# Crypto dependencies optimized
bs58 = "0.4"
base64 = "0.21"
ed25519-dalek = { version = "2.1.1", features = ["rand_core"] }
sha2 = "0.10"

# CLI and logging - minimal features
clap = { version = "4.0", features = ["derive"] }
colored = "2.0"
log = "0.4"

# System dependencies
ctrlc = "3.2"
rand = "0.8"
bincode = "1.3.3"
thiserror = "1.0"
async-trait = "0.1"

# Unicode width dependency for Unicode-aware truncation/padding
unicode-width = "0.1"

# Solana dependencies - with full features needed for trading
solana-sdk = { version = "2.3.1", features = ["full"] }
solana-client = { version = "2.1.0" }
solana-program = { version = "2.3.0" }
solana-account-decoder = { version = "2.2.7" }
solana-transaction-status = { version = "2.3.3" }

# SPL Token dependencies - minimal features
spl-token-2022 = { version = "8.0.1", default-features = false, features = ["no-entrypoint"] }
spl-token = { version = "8.0.0", default-features = false, features = ["no-entrypoint"] }
spl-associated-token-account = { version = "6.0.0", default-features = false, features = ["no-entrypoint"] }
spl-token-confidential-transfer-ciphertext-arithmetic = "0.3.0"

# Web and networking - minimal features
axum = { version = "0.7", features = ["ws"], default-features = false, optional = true }
tower = { version = "0.4", default-features = false, optional = true }
tower-http = { version = "0.5", features = ["cors"], default-features = false, optional = true }
futures = "0.3"
futures-util = "0.3"
url = "2.4"

# Machine learning - minimal features
smartcore = { version = "0.4.2" }

# Utility dependencies
uuid = { version = "1.0", features = ["v4"], default-features = false }
parking_lot = "0.12"
regex = "1.10"
rayon = "1.7"
lazy_static = "1.4"
dashmap = "5.5"

# File and data processing
csv = "1.3.1"
toml = "0.8.23"
glob = "0.3"
dirs = "6.0.0"
tempfile = "3.8"
calamine = { version = "0.18", optional = true }

# Terminal and display
console = "0.15.11"
crossterm = "0.29.0"
indicatif = "0.17.11"
prettytable-rs = "0.10.0"
comfy-table = "7.1.4"
tabled = "0.20"
owo-colors = "4"

# Serialization
borsh = "1.3"
serde_with = "3.12.0"

# Optional heavy dependencies (can be disabled for faster builds)
teloxide = { version = "0.9.1", features = ["macros"], optional = true }
jup-ag = { version = "0.8.0", optional = true }
firebase-rs = { version = "2.2.1", optional = true }
google-cloud-auth = { version = "0.7", optional = true }
gcp_auth = { version = "0.12", optional = true }
fern = { version = "0.7.1", optional = true }
rfd = { version = "0.12", optional = true }
tiny_http = { version = "0.12", optional = true }
dotenv = { version = "0.15", optional = true }
env_logger = { version = "0.10", optional = true }
tokio-util = { version = "0.6", features = ["codec"], optional = true }
num-format = { version = "0.4", optional = true }
chrono-tz = { version = "0.6", optional = true }
ureq = { version = "2.9.1", optional = true }
htmlescape = { version = "0.3", optional = true }
openssl = { version = "0.10", features = ["vendored"], optional = true }

# Feature flags for optional dependencies
[features]
default = ["web", "telegram", "logging"]

# Core features
web = ["dep:axum", "dep:tower", "dep:tower-http", "dep:tiny_http"]
telegram = ["dep:teloxide", "dep:tokio-util", "dep:num-format"]
logging = ["dep:fern", "dep:env_logger", "dep:dotenv"]

# Optional heavy features that can be disabled for faster builds
firebase = ["dep:firebase-rs", "dep:google-cloud-auth", "dep:gcp_auth"]
jupiter = ["dep:jup-ag"]
ui = ["dep:rfd", "dep:calamine"]
time-zones = ["dep:chrono-tz"]
http-client = ["dep:ureq", "dep:htmlescape"]
crypto-extra = ["dep:openssl"]

# Fast build profile - minimal features
fast = []

# Full feature set
full = ["web", "telegram", "logging", "firebase", "jupiter", "ui", "time-zones", "http-client", "crypto-extra"]
