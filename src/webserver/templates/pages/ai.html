<div class="page-table ai-page">
  <div class="ai-layout">
    <!-- Sidebar Navigation -->
    <nav class="ai-sidebar">
      <div class="ai-sidebar-header">
        <div class="sidebar-brand">
          <i class="icon-bot-message-square"></i>
          <span>Assistant</span>
        </div>
      </div>
      <ul class="ai-sidebar-nav">
        <li>
          <button class="ai-nav-item active" type="button" data-tab="chat" aria-label="Chat">
            <span class="nav-item-icon"><i class="icon-message-square"></i></span>
            <span class="ai-nav-label">Chat</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="stats" aria-label="Overview">
            <span class="nav-item-icon"><i class="icon-chart-bar"></i></span>
            <span class="ai-nav-label">Overview</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="providers" aria-label="Providers">
            <span class="nav-item-icon"><i class="icon-bot"></i></span>
            <span class="ai-nav-label">Providers</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="settings" aria-label="Settings">
            <span class="nav-item-icon"><i class="icon-settings"></i></span>
            <span class="ai-nav-label">Settings</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="instructions" aria-label="Instructions">
            <span class="nav-item-icon"><i class="icon-file-text"></i></span>
            <span class="ai-nav-label">Instructions</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="automation" aria-label="Automation">
            <span class="nav-item-icon"><i class="icon-zap"></i></span>
            <span class="ai-nav-label">Automation</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="testing" aria-label="Testing">
            <span class="nav-item-icon"><i class="icon-flask-conical"></i></span>
            <span class="ai-nav-label">Testing</span>
          </button>
        </li>
        <li>
          <button class="ai-nav-item" type="button" data-tab="history" aria-label="History">
            <span class="nav-item-icon"><i class="icon-scroll-text"></i></span>
            <span class="ai-nav-label">History</span>
          </button>
        </li>
      </ul>
    </nav>

    <!-- Main Content Panel -->
    <main class="ai-main-panel">
      <div id="ai-content">
        <!-- Chat Panel (populated by ChatWidget) -->
        <div id="chat-panel" class="ai-panel-content active">
        </div>

        <!-- Stats Panel -->
        <div id="stats-panel" class="ai-panel-content">
          <!-- AI Status Control -->
          <div class="ai-status-bar" id="ai-status-bar">
            <div class="status-bar-main">
              <div class="status-bar-icon" id="ai-status-icon">
                <i class="icon-bot"></i>
              </div>
              <div class="status-bar-info">
                <span class="status-bar-title">Assistant Module</span>
                <span class="status-bar-status" id="ai-status-text">Loading...</span>
              </div>
            </div>
            <div class="status-bar-toggle">
              <label class="toggle">
                <input type="checkbox" id="stats-ai-toggle" disabled />
                <span class="toggle-track"></span>
              </label>
              <span id="stats-toggle-label" class="toggle-status-label">OFF</span>
            </div>
          </div>

          <!-- Key Metrics Section -->
          <div class="stats-section stats-section-metrics">
            <div class="section-header">
              <h3><i class="icon-chart-bar"></i> Key Metrics</h3>
            </div>
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-icon"><i class="icon-hash"></i></div>
                <div class="metric-content">
                  <div class="metric-label">Total Evaluations</div>
                  <div class="metric-value" id="metric-total-evaluations">0</div>
                </div>
              </div>
              <div class="metric-card">
                <div class="metric-icon"><i class="icon-zap"></i></div>
                <div class="metric-content">
                  <div class="metric-label">Cache Hit Rate</div>
                  <div class="metric-value" id="metric-cache-hit-rate">0%</div>
                </div>
              </div>
              <div class="metric-card">
                <div class="metric-icon"><i class="icon-timer"></i></div>
                <div class="metric-content">
                  <div class="metric-label">Avg Latency</div>
                  <div class="metric-value" id="metric-avg-latency">0ms</div>
                </div>
              </div>
              <div class="metric-card">
                <div class="metric-icon"><i class="icon-server"></i></div>
                <div class="metric-content">
                  <div class="metric-label">Providers</div>
                  <div class="metric-value" id="metric-providers">0 / 10</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Recent Decisions Section -->
          <div class="stats-section stats-section-decisions">
            <div class="section-header">
              <h3><i class="icon-list"></i> Recent Decisions</h3>
              <span class="section-subtitle">Last 10 Assistant evaluations</span>
            </div>
            <div id="recent-decisions-container"></div>
          </div>
        </div>

        <!-- Providers Panel -->
        <div id="providers-panel" class="ai-panel-content">
          <div class="ai-panel-header">
            <h2 class="ai-panel-title">LLM Providers</h2>
            <p class="ai-panel-description">
              Configure Assistant providers for intelligent token analysis
            </p>
          </div>

          <div class="providers-list-container">
            <!-- NOTE: Provider logos are loaded dynamically. Alt text is set via JS for proper provider names. -->
            <div class="providers-list" id="providers-list">
              <!-- Dynamically rendered by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Settings Panel -->
        <div id="settings-panel" class="ai-panel-content">
          <!-- Master Settings Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Master Settings</h3>
              <p class="settings-card-description">Core Assistant module configuration</p>
            </div>
            <div class="settings-card-body">
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-enabled">Assistant Module</label>
                  <span class="setting-description"
                    >Enable intelligent token analysis using LLM providers</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-enabled" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-default-provider"
                    >Default Provider</label
                  >
                  <span class="setting-description"
                    >Primary Assistant provider to use for token analysis</span
                  >
                </div>
                <div class="setting-control">
                  <div class="custom-select">
                    <select id="setting-default-provider">
                      <option value="">Select Provider...</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Filtering Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Filtering</h3>
              <p class="settings-card-description">
                Assistant-powered token filtering before entry decisions
              </p>
            </div>
            <div class="settings-card-body">
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-filtering-enabled"
                    >Assistant Token Filtering</label
                  >
                  <span class="setting-description"
                    >Evaluate tokens with Assistant before allowing entry trades</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-filtering-enabled" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-min-confidence"
                    >Minimum Confidence</label
                  >
                  <span class="setting-description"
                    >Tokens must score at least this confidence level to pass (0-100)</span
                  >
                </div>
                <div class="setting-control">
                  <div class="range-slider">
                    <input
                      type="range"
                      id="setting-min-confidence"
                      min="0"
                      max="100"
                      step="5"
                      value="70"
                    />
                    <span class="range-value" id="slider-value-min-confidence">70</span>
                  </div>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-fallback-pass">Fallback to Pass</label>
                  <span class="setting-description"
                    >Allow token entry if Assistant evaluation fails or times out</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-fallback-pass" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- Trading Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Trading</h3>
              <p class="settings-card-description">Assistant analysis during trading operations</p>
            </div>
            <div class="settings-card-body">
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-entry-analysis">Entry Analysis</label>
                  <span class="setting-description"
                    >Run Assistant analysis before opening positions</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-entry-analysis" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-exit-analysis">Exit Analysis</label>
                  <span class="setting-description"
                    >Run Assistant analysis before closing positions</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-exit-analysis" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-trailing-stop"
                    >Trailing Stop Analysis</label
                  >
                  <span class="setting-description"
                    >Run Assistant analysis when trailing stops are triggered</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-trailing-stop" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- Auto Blacklist Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Auto Blacklist</h3>
              <p class="settings-card-description">
                Automatically block tokens based on Assistant scores
              </p>
            </div>
            <div class="settings-card-body">
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-auto-blacklist-enabled"
                    >Auto Blacklist</label
                  >
                  <span class="setting-description"
                    >Automatically blacklist tokens with very low Assistant scores</span
                  >
                </div>
                <div class="setting-control">
                  <label class="toggle">
                    <input type="checkbox" id="setting-auto-blacklist-enabled" />
                    <span class="toggle-track"></span>
                  </label>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-blacklist-min-confidence"
                    >Blacklist Threshold</label
                  >
                  <span class="setting-description"
                    >Tokens scoring below this level will be auto-blacklisted (0-100)</span
                  >
                </div>
                <div class="setting-control">
                  <div class="range-slider">
                    <input
                      type="range"
                      id="setting-blacklist-min-confidence"
                      min="0"
                      max="100"
                      step="5"
                      value="30"
                    />
                    <span class="range-value" id="slider-value-blacklist-min-confidence">30</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Performance Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Performance</h3>
              <p class="settings-card-description">Caching and concurrency settings</p>
            </div>
            <div class="settings-card-body">
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-cache-ttl">Cache TTL</label>
                  <span class="setting-description"
                    >How long to cache Assistant results (60-3600 seconds)</span
                  >
                </div>
                <div class="setting-control">
                  <div class="range-slider">
                    <input
                      type="range"
                      id="setting-cache-ttl"
                      min="60"
                      max="3600"
                      step="60"
                      value="300"
                    />
                    <span class="range-value" id="slider-value-cache-ttl">300</span>
                  </div>
                </div>
              </div>
              <div class="setting-item">
                <div class="setting-info">
                  <label class="setting-label" for="setting-max-evaluations">Max Evaluations</label>
                  <span class="setting-description"
                    >Maximum concurrent Assistant evaluations allowed (1-20)</span
                  >
                </div>
                <div class="setting-control">
                  <div class="range-slider">
                    <input
                      type="range"
                      id="setting-max-evaluations"
                      min="1"
                      max="20"
                      step="1"
                      value="5"
                    />
                    <span class="range-value" id="slider-value-max-evaluations">5</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Cache Management Card -->
          <div class="settings-card">
            <div class="settings-card-header">
              <h3 class="settings-card-title">Cache Management</h3>
              <p class="settings-card-description">View and clear cached Assistant evaluations</p>
            </div>
            <div class="settings-card-body">
              <div class="cache-stats">
                <div class="cache-stat">
                  <span class="cache-stat-label">Cache Size:</span>
                  <span class="cache-stat-value" id="cache-size">0</span>
                </div>
                <div class="cache-stat">
                  <span class="cache-stat-label">Memory Usage:</span>
                  <span class="cache-stat-value" id="cache-memory">0 KB</span>
                </div>
              </div>
              <button type="button" class="btn btn-secondary" id="clear-cache-btn">
                <i class="icon-trash-2"></i> Clear Cache
              </button>
            </div>
          </div>
        </div>

        <!-- Testing Panel -->
        <div id="testing-panel" class="ai-panel-content">
          <div class="testing-section">
            <div class="section-header">
              <h3><i class="icon-flask"></i> Assistant Testing Playground</h3>
              <span class="section-subtitle">Test Assistant analysis on any token</span>
            </div>

            <div class="testing-form">
              <div class="form-group">
                <label for="test-mint-address">Mint Address</label>
                <input
                  type="text"
                  id="test-mint-address"
                  class="form-control"
                  placeholder="Enter Solana token mint address..."
                />
              </div>

              <div class="form-group">
                <label for="test-priority">Priority</label>
                <select id="test-priority" class="form-control">
                  <option value="low">Low</option>
                  <option value="medium" selected>Medium</option>
                  <option value="high">High</option>
                </select>
              </div>

              <button type="button" class="btn btn-primary" id="evaluate-btn">
                <i class="icon-play"></i> Evaluate
              </button>
            </div>

            <div id="testing-results" class="testing-results" style="display: none">
              <div class="section-header">
                <h4><i class="icon-file-text"></i> Results</h4>
              </div>
              <div id="testing-results-content"></div>
            </div>
          </div>
        </div>

        <!-- Instructions Panel -->
        <div id="instructions-panel" class="ai-panel-content">
          <div class="ai-panel-header">
            <div class="panel-header-content">
              <h2 class="ai-panel-title">Custom Instructions</h2>
              <p class="ai-panel-description">
                Add custom prompts that are injected into Assistant evaluations
              </p>
            </div>
            <button type="button" class="btn btn-primary" id="new-instruction-btn">
              <i class="icon-plus"></i> New Instruction
            </button>
          </div>

          <!-- Filters and Search -->
          <div class="instructions-toolbar">
            <div class="filter-group">
              <select id="instructions-category-filter" class="filter-select">
                <option value="all">All Categories</option>
                <option value="filtering">Filtering</option>
                <option value="trading">Trading</option>
                <option value="analysis">Analysis</option>
                <option value="general">General</option>
              </select>
              <select id="instructions-status-filter" class="filter-select">
                <option value="all">All Status</option>
                <option value="active">Active Only</option>
                <option value="inactive">Inactive Only</option>
              </select>
            </div>
            <div class="search-box">
              <input
                type="text"
                id="instructions-search"
                placeholder="Search instructions..."
                class="search-input"
              />
              <i class="search-icon icon-search"></i>
            </div>
          </div>

          <!-- Instructions List -->
          <div class="instructions-list-container">
            <div class="instructions-list" id="instructions-list">
              <!-- Rendered by JavaScript -->
              <div class="empty-state" id="no-instructions">
                <i class="empty-icon icon-file-text"></i>
                <p class="empty-text">No custom instructions yet</p>
                <button type="button" class="btn btn-secondary" id="empty-add-instruction-btn">
                  Add Your First Instruction
                </button>
              </div>
            </div>
          </div>

          <!-- Templates Section (Collapsible) -->
          <div class="templates-section">
            <div class="templates-header" id="templates-toggle-btn">
              <div class="templates-title">
                <i class="templates-icon icon-library"></i>
                <span>Instruction Templates</span>
              </div>
              <span class="templates-toggle" id="templates-toggle">▼</span>
            </div>
            <div class="templates-body" id="templates-body">
              <p class="templates-description">Pre-built instruction templates you can add</p>
              <div class="templates-grid" id="templates-list">
                <!-- Rendered by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <!-- Automation Panel -->
        <div id="automation-panel" class="ai-panel-content">
          <div class="ai-panel-header">
            <div class="panel-header-content">
              <h2 class="ai-panel-title">Automation</h2>
              <p class="ai-panel-description">
                Schedule AI tasks to run automatically on intervals or at specific times
              </p>
            </div>
            <button type="button" class="btn btn-primary" id="new-automation-btn" aria-label="Create new automation task">
              <i class="icon-plus"></i> New Task
            </button>
          </div>

          <!-- Automation Stats Summary -->
          <div class="automation-stats" id="automation-stats">
            <div class="automation-stat-card">
              <div class="stat-value" id="auto-stat-total">0</div>
              <div class="stat-label">Total Tasks</div>
            </div>
            <div class="automation-stat-card">
              <div class="stat-value" id="auto-stat-active">0</div>
              <div class="stat-label">Active</div>
            </div>
            <div class="automation-stat-card">
              <div class="stat-value" id="auto-stat-runs">0</div>
              <div class="stat-label">Total Runs</div>
            </div>
            <div class="automation-stat-card">
              <div class="stat-value" id="auto-stat-success-rate">—</div>
              <div class="stat-label">Success Rate</div>
            </div>
          </div>

          <!-- Task List -->
          <div class="automation-list-container">
            <div class="automation-list" id="automation-list">
              <div class="empty-state" id="no-automation-tasks">
                <i class="empty-icon icon-zap"></i>
                <p class="empty-text">No scheduled tasks yet</p>
                <p class="empty-state-subtitle">Create your first automated AI task to get started</p>
                <button type="button" class="btn btn-secondary" id="empty-add-automation-btn" aria-label="Create first automation task">
                  Create Your First Task
                </button>
              </div>
            </div>
          </div>

          <!-- Recent Runs Timeline -->
          <div class="automation-runs-section">
            <div class="automation-runs-header">
              <h3 class="automation-runs-title">
                <i class="icon-clock"></i> Recent Runs
              </h3>
              <span class="automation-runs-count" id="auto-runs-count"></span>
            </div>
            <div class="automation-runs-list" id="automation-runs-list">
              <!-- Rendered by JavaScript -->
            </div>
          </div>
        </div>

        <!-- History Panel -->
        <div id="history-panel" class="ai-panel-content">
          <div class="history-section">
            <div class="section-header">
              <h3><i class="icon-clock"></i> Decision History</h3>
              <span class="section-subtitle">Recent Assistant evaluations</span>
            </div>
            <div id="history-list" class="history-list"></div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
