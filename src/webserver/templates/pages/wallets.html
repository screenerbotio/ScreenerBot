<div class="wallets-page">
  <!-- Header Section -->
  <header class="wallets-header">
    <div class="header-left">
      <div class="page-badge">
        <i class="icon-wallet"></i>
      </div>
      <div class="page-info">
        <div class="page-title-row">
          <h1>Wallet Manager</h1>
          <span class="wallet-count-badge" id="wallet-count-badge">0 wallets</span>
        </div>
        <p>Securely manage multiple Solana wallets for trading and tools</p>
      </div>
    </div>
    <div class="header-right">
      <div class="header-actions">
        <button
          class="hint-trigger hint-trigger--header"
          id="security-hint-btn"
          type="button"
          aria-label="Security information"
          data-tooltip="Bank-Grade Encryption"
        >
          <i class="icon-shield-check"></i>
        </button>
        <button
          class="btn"
          id="refresh-wallets-btn"
          type="button"
          data-tooltip="Refresh wallet list"
          aria-label="Refresh wallet list"
        >
          <i class="icon-refresh-cw"></i>
        </button>
        <button class="btn" id="import-wallets-btn" type="button">
          <i class="icon-upload"></i> Import
        </button>
        <button class="btn" id="export-wallets-btn" type="button">
          <i class="icon-download"></i> Export
        </button>
        <button class="btn primary" id="add-wallet-btn" type="button">
          <i class="icon-plus"></i> Add Wallet
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="wallets-main">
    <!-- Sub-tabs Container -->
    <div id="wallets-tabs-container" class="sub-tabs-container"></div>

    <!-- Tab Panels -->
    <div class="wallets-tab-panels">
      <!-- Main Wallet Tab Panel -->
      <div class="wallet-tab-panel" id="panel-main" data-panel="main">
        <!-- Main Wallet Card -->
        <div class="main-wallet-section">
          <div class="main-wallet-card" id="main-wallet-card">
            <div class="loading-state">
              <i class="icon-loader spin"></i>
              <p>Loading main wallet...</p>
            </div>
          </div>
        </div>

        <!-- Wallet Stats -->
        <div class="wallets-stats" id="wallets-stats">
          <div class="stat-card">
            <div class="stat-icon sol">
              <i class="icon-coins"></i>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-sol-balance">0.0000</span>
              <span class="stat-label">SOL Balance</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="icon-coins"></i>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-token-count">0</span>
              <span class="stat-label">Token Holdings</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon secondary">
              <i class="icon-layers"></i>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-secondary-count">0</span>
              <span class="stat-label">Secondary Wallets</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="icon-clock"></i>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-last-activity">—</span>
              <span class="stat-label">Last Activity</span>
            </div>
          </div>
        </div>

        <!-- Token Holdings Table -->
        <div class="token-holdings-section">
          <div class="section-header">
            <h3><i class="icon-coins"></i> Token Holdings</h3>
          </div>
          <div class="token-holdings-table" id="token-holdings-table">
            <div class="empty-state">
              <i class="icon-inbox"></i>
              <p>No token holdings</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Secondaries Tab Panel -->
      <div class="wallet-tab-panel hidden" id="panel-secondaries" data-panel="secondaries">
        <div id="secondaries-table-container"></div>
      </div>

      <!-- Archive Tab Panel -->
      <div class="wallet-tab-panel hidden" id="panel-archive" data-panel="archive">
        <div id="archive-table-container"></div>
      </div>
    </div>
  </main>

  <!-- Add Wallet Modal -->
  <div class="modal-overlay hidden" id="add-wallet-modal">
    <div class="modal-dialog">
      <div class="modal-header">
        <h2><i class="icon-wallet"></i> Add Wallet</h2>
        <button class="modal-close" type="button" id="modal-close-btn" aria-label="Close modal">
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <!-- Tab Navigation -->
        <div class="modal-tabs">
          <button class="modal-tab active" type="button" data-tab="create">
            <i class="icon-circle-plus"></i> Create New
          </button>
          <button class="modal-tab" type="button" data-tab="import">
            <i class="icon-download"></i> Import Existing
          </button>
        </div>

        <!-- Create Wallet Form -->
        <div class="modal-tab-content" id="create-tab-content">
          <form class="wallet-form" id="create-wallet-form">
            <div class="form-group">
              <label for="create-name">Wallet Name <span class="required">*</span></label>
              <input
                type="text"
                id="create-name"
                placeholder="e.g., Trading Wallet"
                required
                maxlength="50"
              />
              <small>A friendly name to identify this wallet</small>
            </div>
            <div class="form-group">
              <label for="create-notes">Notes</label>
              <textarea
                id="create-notes"
                placeholder="Optional description or purpose..."
                rows="2"
                maxlength="200"
              ></textarea>
            </div>
            <div class="form-group checkbox-group">
              <label>
                <input type="checkbox" id="create-set-main" />
                <span>Set as main wallet</span>
              </label>
              <small>This wallet will be used for auto-trading operations</small>
            </div>
            <div class="form-actions">
              <button type="button" class="btn" id="create-cancel-btn">Cancel</button>
              <button type="submit" class="btn primary">
                <i class="icon-plus"></i> Create Wallet
              </button>
            </div>
          </form>
        </div>

        <!-- Import Wallet Form -->
        <div class="modal-tab-content hidden" id="import-tab-content">
          <div class="warning-banner">
            <i class="icon-triangle-alert"></i>
            <div>
              <strong>Security Warning</strong>
              <p>
                Only import private keys from trusted sources. Your key will be encrypted and stored
                securely on this device.
              </p>
            </div>
          </div>
          <form class="wallet-form" id="import-wallet-form">
            <div class="form-group">
              <label for="import-name">Wallet Name <span class="required">*</span></label>
              <input
                type="text"
                id="import-name"
                placeholder="e.g., My Wallet"
                required
                maxlength="50"
              />
            </div>
            <div class="form-group">
              <label for="import-private-key">Private Key <span class="required">*</span></label>
              <div class="password-input-wrapper">
                <textarea
                  id="import-private-key"
                  placeholder="Base58 string or JSON array [1,2,3,...]"
                  rows="3"
                  required
                  class="secure-input"
                ></textarea>
                <button
                  type="button"
                  class="toggle-visibility"
                  data-target="import-private-key"
                  aria-label="Toggle private key visibility"
                  aria-pressed="false"
                  role="switch"
                >
                  <i class="icon-eye"></i>
                </button>
              </div>
              <small>Supports base58 encoded key or byte array format</small>
            </div>
            <div class="form-group">
              <label for="import-notes">Notes</label>
              <textarea
                id="import-notes"
                placeholder="Optional description..."
                rows="2"
                maxlength="200"
              ></textarea>
            </div>
            <div class="form-group checkbox-group">
              <label>
                <input type="checkbox" id="import-set-main" />
                <span>Set as main wallet</span>
              </label>
            </div>
            <div class="form-actions">
              <button type="button" class="btn" id="import-cancel-btn">Cancel</button>
              <button type="submit" class="btn primary">
                <i class="icon-download"></i> Import Wallet
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Export Key Modal -->
  <div class="modal-overlay hidden" id="export-modal">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <h2><i class="icon-key"></i> Export Private Key</h2>
        <button class="modal-close" type="button" id="export-modal-close" aria-label="Close modal">
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="danger-banner">
          <i class="icon-triangle-alert"></i>
          <div>
            <strong>⚠️ Critical Security Warning</strong>
            <p>
              Never share your private key with anyone. Anyone with access to this key can steal all
              funds from this wallet.
            </p>
          </div>
        </div>
        <div class="export-key-display hidden" id="export-key-display">
          <label>Private Key (Base58)</label>
          <div class="key-display">
            <code id="exported-key">...</code>
            <button
              type="button"
              class="btn-icon"
              id="copy-key-btn"
              data-tooltip="Copy to clipboard"
              aria-label="Copy to clipboard"
            >
              <i class="icon-copy"></i>
            </button>
          </div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn" id="export-cancel-btn">Cancel</button>
          <button type="button" class="btn danger" id="confirm-export-btn">
            <i class="icon-lock-open"></i> Reveal Key
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Archive Confirmation Modal -->
  <div class="modal-overlay hidden" id="archive-modal">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <h2><i class="icon-archive"></i> Archive Wallet</h2>
        <button class="modal-close" type="button" id="archive-modal-close" aria-label="Close modal">
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <p class="confirm-text">
          Are you sure you want to archive <strong id="archive-wallet-name">this wallet</strong>?
        </p>
        <p class="info-text">
          Archived wallets are not used in any operations but can be restored anytime.
        </p>
        <div class="form-actions">
          <button type="button" class="btn" id="archive-cancel-btn">No</button>
          <button type="button" class="btn primary" id="confirm-archive-btn">
            <i class="icon-archive"></i> Yes, Archive
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-overlay hidden" id="delete-modal">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <h2><i class="icon-trash-2"></i> Delete Wallet</h2>
        <button class="modal-close" type="button" id="delete-modal-close" aria-label="Close modal">
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="danger-banner">
          <i class="icon-triangle-alert"></i>
          <div>
            <strong>This action cannot be undone!</strong>
            <p>
              Deleting this wallet will permanently remove it and its encrypted private key from
              this device.
            </p>
          </div>
        </div>
        <p class="confirm-text">
          Are you sure you want to delete <strong id="delete-wallet-name">this wallet</strong>?
        </p>
        <div class="form-actions">
          <button type="button" class="btn" id="delete-cancel-btn">No</button>
          <button type="button" class="btn danger" id="confirm-delete-btn">
            <i class="icon-trash-2"></i> Yes, Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Import Modal -->
  <div class="modal-overlay hidden" id="bulk-import-modal">
    <div class="modal-dialog modal-lg">
      <div class="modal-header">
        <h2><i class="icon-upload"></i> Import Wallets</h2>
        <button
          class="modal-close"
          type="button"
          id="bulk-import-modal-close"
          aria-label="Close modal"
        >
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <!-- Step Indicator -->
        <div class="import-steps">
          <div class="import-step active" data-step="1">
            <span class="step-number">1</span>
            <span class="step-label">Upload File</span>
          </div>
          <div class="step-connector"></div>
          <div class="import-step" data-step="2">
            <span class="step-number">2</span>
            <span class="step-label">Map Columns</span>
          </div>
          <div class="step-connector"></div>
          <div class="import-step" data-step="3">
            <span class="step-number">3</span>
            <span class="step-label">Results</span>
          </div>
        </div>

        <!-- Step 1: File Upload -->
        <div class="import-step-content" id="import-step-1">
          <div class="warning-banner">
            <i class="icon-triangle-alert"></i>
            <div>
              <strong>Security Warning</strong>
              <p>
                Only import files from trusted sources. Private keys will be encrypted and stored
                securely on this device.
              </p>
            </div>
          </div>
          <div class="file-dropzone" id="import-dropzone">
            <div class="dropzone-content">
              <i class="icon-cloud-upload"></i>
              <p class="dropzone-title">Drop your file here</p>
              <p class="dropzone-subtitle">or click to browse</p>
              <span class="dropzone-formats">Supports CSV and Excel (.xlsx, .xls)</span>
            </div>
            <input type="file" id="import-file-input" accept=".csv,.xlsx,.xls" hidden />
          </div>
          <div class="selected-file hidden" id="selected-file-info">
            <i class="icon-file-text"></i>
            <span id="selected-file-name">filename.csv</span>
            <button type="button" class="btn-icon" id="clear-file-btn" aria-label="Remove file">
              <i class="icon-x"></i>
            </button>
          </div>
          <div class="form-actions">
            <button type="button" class="btn" id="import-step1-cancel">Cancel</button>
            <button type="button" class="btn primary" id="import-step1-next" disabled>
              <i class="icon-arrow-right"></i> Next
            </button>
          </div>
        </div>

        <!-- Step 2: Column Mapping & Preview -->
        <div class="import-step-content hidden" id="import-step-2">
          <div class="column-mapping-section">
            <h4><i class="icon-settings"></i> Map Columns</h4>
            <p class="mapping-subtitle">Match your file columns to wallet fields</p>
            <div class="column-mapping-grid" id="column-mapping-grid">
              <!-- Dynamically populated -->
            </div>
          </div>
          <div class="preview-section">
            <h4><i class="icon-eye"></i> Preview (First 5 Rows)</h4>
            <div class="preview-table-wrapper" id="preview-table-wrapper">
              <!-- Dynamically populated -->
            </div>
          </div>
          <div class="import-summary" id="import-summary">
            <div class="summary-item valid">
              <i class="icon-circle-check"></i>
              <span><strong id="valid-count">0</strong> valid</span>
            </div>
            <div class="summary-item invalid">
              <i class="icon-circle-x"></i>
              <span><strong id="invalid-count">0</strong> invalid</span>
            </div>
            <div class="summary-item duplicate">
              <i class="icon-copy"></i>
              <span><strong id="duplicate-count">0</strong> duplicates</span>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn" id="import-step2-back">
              <i class="icon-arrow-left"></i> Back
            </button>
            <button type="button" class="btn primary" id="import-step2-execute" disabled>
              <i class="icon-upload"></i> Import Wallets
            </button>
          </div>
        </div>

        <!-- Step 3: Import Results -->
        <div class="import-step-content hidden" id="import-step-3">
          <div class="import-results-header" id="import-results-header">
            <!-- Dynamically populated with success/error summary -->
          </div>
          <div class="import-results-table-wrapper" id="import-results-table">
            <!-- Dynamically populated -->
          </div>
          <div class="form-actions">
            <button type="button" class="btn primary" id="import-step3-done">
              <i class="icon-check"></i> Done
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Export Modal -->
  <div class="modal-overlay hidden" id="bulk-export-modal">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <h2><i class="icon-download"></i> Export Wallets</h2>
        <button
          class="modal-close"
          type="button"
          id="bulk-export-modal-close"
          aria-label="Close modal"
        >
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <!-- Export Options -->
        <div class="export-options">
          <div class="form-group">
            <label for="export-format">Format</label>
            <select id="export-format" data-custom-select>
              <option value="csv">CSV (.csv)</option>
              <option value="xlsx">Excel (.xlsx)</option>
            </select>
          </div>
          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" id="export-include-inactive" />
              <span>Include archived wallets</span>
            </label>
          </div>
        </div>

        <!-- Export Without Keys Section -->
        <div class="export-safe-section">
          <div class="info-banner">
            <i class="icon-shield-check"></i>
            <div>
              <strong>Safe Export</strong>
              <p>Export wallet addresses and metadata only. No private keys included.</p>
            </div>
          </div>
          <button type="button" class="btn primary full-width" id="export-safe-btn">
            <i class="icon-download"></i> Export Addresses
          </button>
        </div>

        <div class="export-divider">
          <span>or</span>
        </div>

        <!-- Export With Keys Section (Dangerous) -->
        <div class="export-keys-section">
          <div class="danger-banner">
            <i class="icon-triangle-alert"></i>
            <div>
              <strong>⚠️ Dangerous Export</strong>
              <p>Include private keys in the export. Anyone with this file can steal your funds.</p>
            </div>
          </div>
          <button type="button" class="btn danger full-width" id="export-with-keys-btn">
            <i class="icon-lock-open"></i> Export with Private Keys
          </button>
        </div>

        <div class="form-actions">
          <button type="button" class="btn" id="export-cancel-btn">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Export Keys Confirmation Modal -->
  <div class="modal-overlay hidden" id="export-keys-confirm-modal">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <h2><i class="icon-triangle-alert"></i> Confirm Dangerous Export</h2>
        <button
          class="modal-close"
          type="button"
          id="export-keys-confirm-close"
          aria-label="Close modal"
        >
          <i class="icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="danger-banner">
          <i class="icon-triangle-alert"></i>
          <div>
            <strong>⚠️ Critical Security Warning</strong>
            <p>
              You are about to export <strong id="export-wallet-count">0</strong> private keys. This
              is extremely dangerous!
            </p>
            <ul class="danger-list">
              <li>Anyone with this file can steal all funds</li>
              <li>Never share this file with anyone</li>
              <li>Delete the file immediately after use</li>
            </ul>
          </div>
        </div>
        <div class="form-group">
          <label for="export-confirm-input">Type "EXPORT KEYS" to confirm</label>
          <input
            type="text"
            id="export-confirm-input"
            placeholder="EXPORT KEYS"
            autocomplete="off"
          />
        </div>
        <div class="form-actions">
          <button type="button" class="btn" id="export-keys-confirm-cancel">Cancel</button>
          <button type="button" class="btn danger" id="export-keys-confirm-btn" disabled>
            <i class="icon-download"></i> Export Keys
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
